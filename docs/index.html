<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video Gallery</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header>
        <h1 id="main-title">ARC-NCA Solutions and Partial Solutions</h1>
    </header>
    <main>
            <h2 class="video-section-header">EngramNCA v1 Solutions and Partial Solutions</h2>
            <div class="video-grid">

                <div class="video-item">
                    <video id="video-1" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_103.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_103.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_103</p>
                </div>

                <div class="video-item">
                    <video id="video-2" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_11.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_11.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_11</p>
                </div>

                <div class="video-item">
                    <video id="video-3" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_116.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_116.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_116</p>
                </div>

                <div class="video-item">
                    <video id="video-4" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_118.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_118.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_118</p>
                </div>

                <div class="video-item">
                    <video id="video-5" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_120.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_120.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_120</p>
                </div>

                <div class="video-item">
                    <video id="video-6" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_136.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_136.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_136</p>
                </div>

                <div class="video-item">
                    <video id="video-7" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_150.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_150.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_150</p>
                </div>

                <div class="video-item">
                    <video id="video-8" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_154.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_154.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_154</p>
                </div>

                <div class="video-item">
                    <video id="video-9" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_159.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_159.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_159</p>
                </div>

                <div class="video-item">
                    <video id="video-10" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_169.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_169.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_169</p>
                </div>

                <div class="video-item">
                    <video id="video-11" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_185.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_185.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_185</p>
                </div>

                <div class="video-item">
                    <video id="video-12" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_191.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_191.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_191</p>
                </div>

                <div class="video-item">
                    <video id="video-13" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_208.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_208.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_208</p>
                </div>

                <div class="video-item">
                    <video id="video-14" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_209.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_209.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_209</p>
                </div>

                <div class="video-item">
                    <video id="video-15" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_213.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_213.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_213</p>
                </div>

                <div class="video-item">
                    <video id="video-16" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_216.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_216.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_216</p>
                </div>

                <div class="video-item">
                    <video id="video-17" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_222.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_222.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_222</p>
                </div>

                <div class="video-item">
                    <video id="video-18" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_235.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_235.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_235</p>
                </div>

                <div class="video-item">
                    <video id="video-19" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_24.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_24.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_24</p>
                </div>

                <div class="video-item">
                    <video id="video-20" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_254.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_254.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_254</p>
                </div>

                <div class="video-item">
                    <video id="video-21" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_258.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_258.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_258</p>
                </div>

                <div class="video-item">
                    <video id="video-22" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_3.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_3.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_3</p>
                </div>

                <div class="video-item">
                    <video id="video-23" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_39.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_39.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_39</p>
                </div>

                <div class="video-item">
                    <video id="video-24" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_49.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_49.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_49</p>
                </div>

                <div class="video-item">
                    <video id="video-25" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_53.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_53.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_53</p>
                </div>

                <div class="video-item">
                    <video id="video-26" class="lazy-video" controls loop muted playsinline preload="metadata">
                        <source data-src="Videos/EngramNCA v1 Solutions and Partial Solutions/EngramNCA_v1problem_81.mp4" type="video/mp4">
                        Your browser does not support the video tag. (EngramNCA_v1problem_81.mp4)
                    </video>
                    <p class="caption">EngramNCA_v1problem_81</p>
                </div>
            </div> <!-- end .video-grid for section -->

    </main>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const lazyVideos = [].slice.call(document.querySelectorAll("video.lazy-video"));

            if ("IntersectionObserver" in window) {
                const videoObserver = new IntersectionObserver((entries, observer) => {
                    entries.forEach(entry => {
                        const video = entry.target;
                        if (entry.isIntersecting) {
                            // Video is in view
                            const firstSource = video.querySelector("source[data-src]");
                            if (firstSource) {
                                // First time: Set sources, load, and play
                                video.querySelectorAll("source[data-src]").forEach(source => {
                                    source.src = source.dataset.src;
                                    source.removeAttribute('data-src'); // Prevent re-processing
                                });
                                video.load();
                                video.play().catch(error => {
                                    console.log(`Autoplay prevented for ${video.id} on initial load:`, error);
                                    // User might need to interact if autoplay is blocked even with muted.
                                });
                            } else if (video.paused) {
                                // Video was already loaded but is paused, play it
                                video.play().catch(error => {
                                    console.log(`Autoplay prevented for ${video.id} on re-entering view:`, error);
                                });
                            }
                        } else {
                            // Video is out of view, pause it
                            if (!video.paused) {
                                video.pause();
                            }
                        }
                    });
                }, {
                    // Adjust rootMargin and threshold as needed:
                    // rootMargin: "0px 0px 200px 0px" means the "viewport" for intersection checks
                    // extends 200px below the actual viewport. Videos within this margin start loading/playing.
                    // threshold: 0.25 means 25% of the video needs to be visible within the rootMargin area
                    // for 'isIntersecting' to be true.
                    rootMargin: "0px 0px 150px 0px", // Start loading/playing when video is 150px from viewport bottom
                    threshold: 0.2 // Play when at least 20% of the video is visible in the observer's root
                });

                lazyVideos.forEach(function(lazyVideo) {
                    videoObserver.observe(lazyVideo); // Observe for continuous play/pause
                });

            } else {
                // Fallback for browsers that don't support IntersectionObserver
                // Load all videos immediately and try to play (might cause performance issues)
                console.warn("IntersectionObserver not supported. All videos will attempt to load and play at once.");
                lazyVideos.forEach(function(video) {
                    video.querySelectorAll("source[data-src]").forEach(source => {
                        source.src = source.dataset.src;
                        source.removeAttribute('data-src');
                    });
                    video.load();
                    video.play().catch(error => {
                        console.log("Video play prevented (fallback) for " + video.id + ": ", error);
                    });
                });
            }
        });
    </script>
</body>
</html>
